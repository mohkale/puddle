@import "@puddle/styles/config";
@import "@puddle/styles/no-select";

$order-indicator-width: 4px;
$order-indicator-offset: 3px;

$resizer-width: 9px;

@mixin trimWithEllipsis {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

#torrents {
    width: max-content;
    border-collapse: collapse;

    .table-cell {
        @include no-select;
        font-weight: normal;
        box-sizing: border-box;
        padding: 0px 6px;

        display: inline-flex;
        align-items: center;

        .label {
            @include trimWithEllipsis;
        }
    }

    .rows {
        margin: 0px;
        padding: 0px;
        list-style-type: none;

        li {
            height: 30px;
            display: flex;
            align-items: center;

            &:last-child {
                border-bottom: 0px;
            }
        }

        .table-cell {
            font-size: 0.9em;
            font-weight: 400;
            cursor: default;

            .unit {
                font-size: 0.8em;
                font-style: normal;
            }

            & > div {
                @include trimWithEllipsis;
                width: 100%;
            }
        }

        .progress-bar {
            display: grid;
            grid-template-columns: max-content 1fr;
            grid-gap: 4px;

            svg { height: 8px; }
            .fill {
                margin: auto 0px;
            }
            .fill, .progress {
                height: 3px;
            }
        }
    }

    // Start setting up color scheme for rows.

    .rows li {
        color: var(--torrents-row-fg);
        background-color: var(--torrents-row-bg);

        transition: all $animation-duration;
        transition-property: color, background-color, fill, border-color;

        border-top:    solid 1px var(--torrents-border-color);
        border-bottom: solid 1px var(--torrents-border-color);

        &.active {
            --torrents-row-fg: var(--torrents-active-row-fg);
            --torrents-row-bg: var(--torrents-active-row-bg);
            --torrents-row-border-color: var(--torrents-active-row-border-color);
            --torrents-row-progress-bg: var(--torrents-active-row-progress-bg);
            --torrents-row-progress-fg: var(--torrents-active-row-progress-fg);
        }

        .progress-bar {
            .fill {
                background-color: var(--torrents-row-progress-bg);
            }
            .progress {
                background-color: var(--torrents-row-progress-fg);
            }
        }

        /** variants for rows that're in different states. */
        @mixin theme-customize($accessors, $prefix, $selected-prefix) {
            &#{$accessors} {
                --torrents-row-fg: var(#{$prefix}-fg);
                --torrents-row-bg: var(#{$prefix}-bg);
                --torrents-row-border-color: var(#{$prefix}-border-color);
                --torrents-row-progress-fg: var(#{$prefix}-progress-fg);
                --torrents-row-progress-bg: var(#{$prefix}-progress-bg);

                &.active {
                    // not using active here because .active isn't specific enough above.
                    --torrents-row-fg: var(#{$selected-prefix}-fg);
                    --torrents-row-bg: var(#{$selected-prefix}-bg);
                    --torrents-row-border-color: var(#{$selected-prefix}-border-color);
                    --torrents-row-progress-fg: var(#{$selected-prefix}-progress-fg);
                    --torrents-row-progress-bg: var(#{$selected-prefix}-progress-bg);
                }

                @content
            }
        }

        @include theme-customize(
            ":not(.is-stopped)",
            "--torrents-downloading-row",
            "--torrents-active-downloading-row") {
            .Name {
                font-weight: 500;
            }
        }

        @include theme-customize(
            ".is-seeding",
            "--torrents-seeding-row",
            "--torrents-active-seeding-row");

        @include theme-customize(
            ".has-error",
            "--torrents-error-row",
            "--torrents-active-error-row");
    }
}

@import "./columns";
